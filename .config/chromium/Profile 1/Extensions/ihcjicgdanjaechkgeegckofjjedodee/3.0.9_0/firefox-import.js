chrome||browser||(window.chrome=chrome||window.chrome||window.browser),(chrome||window.chrome).runtime.getURL(""),(()=>{"use strict";const e="undefined"!=typeof window?window:self,t=e.chrome||e.browser||browser;let r;console.log(`POLYFILL => User Agent: ${navigator.userAgent}, Browser: ${t}`);try{r=indexedDB||e.indexedDB}catch(e){console.log(`Error initializing indexedDB: ${e.message}`)}performance||e.performance,URL||e.URL,t.i18n.getUILanguage().split("-")[0],Object.freeze({LicenseStateUnknown:0,LicenseStateFree:1,LicenseStateTrial:2,LicenseStateTrialExpired:3,LicenseStateLicensed:4,LicenseStateLicenseExpired:5,LicenseStateLicenseGrace:6}),Object.freeze([2,4,6]);const n=e=>new Promise(((r,n)=>t.runtime.sendMessage({type:"MSG_IMPORT_SETTINGS",data:e},(e=>{!e||e.error||t.runtime.lastError?(console.error("INC_EXP: Failed to import settings",{error:(e?e.error:null)||t.runtime.lastError}),n((e?e.error:null)||t.runtime.lastError)):(console.log("INC_EXP: Successfully imported settings"),r())})))),s=e=>{const r=document.getElementById("img-status"),n=document.getElementById("progress-bar"),s=document.getElementById("progress-percentage"),o=document.getElementById("status-desc");if(r.setAttribute("class",""),n.setAttribute("class",""),"completed"===e)return r.classList.add("import-successful"),n.classList.add("progress-complete"),s.textContent="100%",void(o.textContent=t.i18n.getMessage("ImportStatusDescriptionComplete"));if("unauthorized"===e){const e=document.getElementById("non-premium-desc"),i=document.getElementById("non-premium-txt");return r.classList.add("import-error"),n.classList.add("progress-error"),o.style.display="none",s.textContent="Unauthorized",e.style.display="inherit",void(i.textContent=t.i18n.getMessage("ImportStatusDescriptionUnauthorized"))}const i=document.getElementById("try-again-btn");r.classList.add("import-error"),n.classList.add("progress-error"),s.textContent="Error",o.textContent=t.i18n.getMessage("ImportStatusDescriptionError"),document.getElementById("error-btns-container").style.display="inherit",i.addEventListener("click",(()=>{location.reload()}))},o=async e=>{const r=document.getElementById("drag-and-drop"),o=document.getElementById("progress-container"),i=document.getElementById("status-desc"),d=document.getElementById("file-name");if(!e)return r.classList.remove("drag-over"),console.log("No file selected");console.log("Importing File",e.name);const a=new FileReader,c=document.getElementById("import-btn");if(c.classList.add("loading"),c.disabled=!0,r.remove(),o.style.display="inherit",o.style.opacity=1,d.textContent=`${e.name} - ${t.i18n.getMessage("ImportingTxt")}`,d.style.fontWeight=500,d.style.letterSpacing="0.1px",i.textContent=t.i18n.getMessage("ImportStatusDescriptionOnLoad"),!await new Promise(((e,r)=>{t.runtime.sendMessage({type:"MSG_IS_PREMIUM"},(function(t){!t||t.error?(console.error("Failed to check if premium: "+t.error),r(t.error)):(console.debug("Is premium: "+t.success),e(t.success))}))})))return o.style.display="inherit",o.style.opacity=1,s("unauthorized");a.onload=async e=>{const t=e.target.result;try{await(async e=>{const t=JSON.parse(e);if(!t)throw new Error("Invalid import data");console.debug("INC_EXP: Importing Data",{dataAsJson:t}),await n(t)})(t),s("completed"),console.debug("INC_EXP: Import completed")}catch(e){s("error"),console.error("INC_EXP: Failed to import settings",e)}c.classList.remove("loading"),c.disabled=!1},a.onerror=e=>{c.classList.remove("loading"),c.disabled=!1,console.error("INC_EXP: Failed to import settings",e)},a.onabort=e=>{c.classList.remove("loading"),c.disabled=!1,console.error("INC_EXP: Aborted settings import",e)},a.readAsText(e)};document.addEventListener("DOMContentLoaded",(()=>{((e,r=document)=>{[{id:"dd-title",msg:"DragAndDropTitle"},{id:"dd-desc",msg:"DragAndDropDescription"},{id:"import-btn",msg:"ImportBtnText"},{id:"status-desc",msg:"ImportStatusDescription"},{id:"try-again-btn",msg:"ImportTryAgainBtn"},{id:"contact-support-btn",msg:"ImportSupportBtn"}].forEach((({id:e,msg:n,sub:s=null})=>{const o=r.getElementById(e);o&&(o.textContent=t.i18n.getMessage(n,s||void 0))}))})(),(()=>{const e=document.getElementById("drag-and-drop");e.addEventListener("dragover",(t=>{t.preventDefault(),e.classList.add("drag-over")})),e.addEventListener("dragleave",(t=>{t.preventDefault(),e.classList.remove("drag-over")})),e.addEventListener("drop",(e=>{e.preventDefault();const t=e.dataTransfer.files[0];o(t)})),document.getElementById("file-input").addEventListener("change",(e=>{const t=e.target.files[0];o(t)}))})()}))})();